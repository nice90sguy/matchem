{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":"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","sourcesContent":["\r\n\r\nObject.defineProperty(Array.prototype, 'randomElement', {\r\n    value: function () {\r\n        return this.length ? this[Math.floor(Math.random() * this.length)] : undefined;\r\n    }\r\n});\r\nObject.defineProperty(Array.prototype, 'shuffle', {\r\n    value: function () {\r\n        // Knuth shuffle https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\r\n        for (let i = this.length; i > 0;) {\r\n            const j = Math.floor(Math.random() * i);\r\n            --i;\r\n            const tmp = this[i];\r\n            this[i] = this[j];\r\n            this[j] = tmp;\r\n        }\r\n        return this;\r\n    }\r\n});\r\n\r\nconst gameNum = 0;\r\nconst games = [\r\n    { r: 4, c: 4, l: 2 },\r\n    { r: 6, c: 6, l: 5 },\r\n    { r: 10, c: 10, l: 10 }\r\n]\r\n\r\n\r\nfunction makeGame(rows: number, cols: number, maxLayer: number) : void {\r\n    const numPairs = rows * cols / 2\r\n    // @ts-ignore\r\n    const allEmojisShuffled = allEmojis.shuffle()\r\n    let score = rows * cols / 2 * maxLayer\r\n\r\n    const layers : string[][] = []\r\n    let elToMatch: HTMLDivElement | undefined = undefined\r\n\r\n    const scoreEl= document.querySelector('#score') as HTMLDivElement;\r\n    const containerEl = document.querySelector('#container') as HTMLDivElement;\r\n    let sliceIdx = 0\r\n    // Make the layers\r\n    for (let i = 0; i < maxLayer; ++i) {\r\n        if (sliceIdx + numPairs >= allEmojisShuffled.length)\r\n            alert(\"Todo: Handle exhaustion of emojis\");\r\n        const emojis = allEmojisShuffled.slice(sliceIdx, sliceIdx + numPairs)\r\n\r\n        sliceIdx += numPairs\r\n\r\n        layers.push(emojis.concat(emojis).shuffle())\r\n    }\r\n    // Blank layer\r\n    layers.push(Array(numPairs * 2).fill(\"\") )\r\n\r\n    // Make deck\r\n    scoreEl.innerHTML = score.toFixed(0)\r\n    const deckElement = document.createElement('div');\r\n    deckElement.className = 'deck';\r\n    containerEl.appendChild(deckElement);\r\n    for (let layer = 0; layer <= maxLayer; ++layer) {\r\n        let i = 0;\r\n        const emojis = layers[layer]\r\n\r\n\r\n        for (let row = 0; row < rows; ++row) {\r\n            for (let col = 0; col < cols; ++col) {\r\n                const cellElement = document.createElement('div');\r\n                cellElement.classList.add('tile')\r\n                cellElement.style.zIndex = `${1000-layer}`\r\n                cellElement.id = `${layer}-${i}`;\r\n                cellElement.innerText = emojis[i++]\r\n                cellElement.style.left = col * 80 + \"px\"\r\n                cellElement.style.top = row * 80 + \"px\"\r\n                deckElement.appendChild(cellElement);\r\n                cellElement.ontransitionend = () => {\r\n                    if (cellElement.classList.contains('rotateOut'))\r\n                        cellElement.remove();\r\n                    else\r\n                        cellElement.classList.remove(\"rotateBack\");\r\n\r\n                }\r\n                cellElement.addEventListener('click', () => {\r\n                    if (cellElement.innerText !== \"\") {\r\n                        if (elToMatch === undefined) {\r\n                            cellElement.classList.add(\"selected\");\r\n                            elToMatch = cellElement\r\n                        } else if (cellElement.innerText === elToMatch.innerText && cellElement !== elToMatch) {\r\n                            score -= 1;\r\n                            scoreEl.innerHTML = score.toFixed(0)\r\n                            elToMatch.classList.add('rotateOut')\r\n                            cellElement.classList.add('rotateOut')\r\n                            elToMatch = undefined;\r\n                        } else {\r\n                            cellElement.classList.add(\"rotateBack\");\r\n                            elToMatch.classList.add(\"rotateBack\");\r\n                            elToMatch.classList.remove(\"selected\");\r\n                            elToMatch = undefined;\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nmakeGame(6, 8, 10);\r\n\r\n"]}